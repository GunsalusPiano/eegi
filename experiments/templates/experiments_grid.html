{% extends "base.html" %}
{% load extra_tags %}

{% block body_id %}experiment-grid{% endblock %}

{% block page_title %}
Grid of All
{% ifequal screen_stage '1' %}
Primary
{% else %}
Secondary
{% endifequal %}
Experiments
{% endblock %}

{% block content %}

<table id="experiment-grid-table" class="grid">
  <thead>
    <tr>
      <th></th>
      {% for worm, temp in header %}
      <th>
        {{ worm }}
        <br>
        {{ worm.gene }}
        <br>
        {{ temp|get_celsius_string }}
      </th>
      {% endfor %}
    </tr>
  </thead>

  <tbody>
    {% for plate, worms in e.items %}
    <tr>
      <th>{{ plate }}</th>
      {% for worm, temperatures in worms.items %}
        {% for temperature, experiments in temperatures.items %}
        <td
          {% if screen_stage == '1' and experiments|length < 2 %}
            class="error-background"
          {% elif screen_stage == '1' and experiments|length > 2 %}
            class="warning-background"
          {% elif experiments and screen_stage == '2' and experiments|length < 8 %}
            class="error-background"
          {% elif experiments and screen_stage == '2' and experiments|length > 8 %}
            class="warning-background"
          {% endif %}
        >
          {{ plate }}
          <br>
          {{ worm }}
          <br>
          {{ temperature|get_celsius_string }}

          <ol>
            {% for experiment in experiments %}
            <li>
            <a href="{% url 'experiment_url' experiment.id %}">
              _{{ experiment.id }}_</a>
            </li>
            {% endfor %}
          </ol>

          {% if experiments %}
            <a href="
              {% url 'experiments_vertical_url' experiments|concatenate_ids_with_commas %}">
              all</a>
          {% endif %}
        </td>
        {% endfor %}
      {% endfor %}
    </tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}
