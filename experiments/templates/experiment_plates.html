{% extends 'base.html' %}
{% load extra_tags %}


{% block body_id %}experiment-plates{% endblock %}


{% block page_title %}Experiment Plates{% endblock %}


{% block content %}

<div class="page-section">
  <h4>Browse all experiment plates in grid format</h4>

  <a href="{% url 'experiment_plates_grid_url' 1 %}">
    Primary screen (non-junk, official temps only)</a>

  <br>
  <br>

  <a href="{% url 'experiment_plates_grid_url' 2 %}">
    Secondary screen (non-junk, official temps only)</a>
</div>

<div class="page-section">
  <hr>
</div>

<div class="page-section">
  <h4>Find experiment plates</h4>

  {% if form.errors %}
  <span class="error-message">
    Please correct the error{{ form.errors|pluralize }} below.
  </span>
  {% endif %}

  <form action="" method="get">
    <table>
      {{ form.as_table }}
    </table>
    <input type="submit" value="Submit">
  </form>
</div>

<div class="page-section">
  {% ifnotequal experiment_plates None %}
  <div id="results-header">
    <span id="total">
      {{ experiment_plates|length }} matching
      plate{{ experiment_plates|pluralize }}
    </span>

    {% if experiment_plates %}
    {% url 'experiment_plates_vertical_url' experiment_plates|concatenate_ids_with_commas as vertical_url %}
    <span class="vertical-links">
      <a href="{{ vertical_url }}"
          {% if experiment_plates|length > 500 %}class="inactive-link"{% endif %}>
        See all thumbnails (max 500 expts)</a>

      <a href="{{ vertical_url }}?mode=big"
          {% if experiment_plates|length > 50 %}class="inactive-link"{% endif %}>
        See all full-size (max 50)</a>

      <a href="{{ vertical_url }}?mode=devstar"
          {% if experiment_plates|length > 50 %}class="inactive-link"{% endif %}>
        See all DevStaR (max 50)</a>
    </span>

    {% include 'pagination_status.html' with paginated=experiment_plates %}

    {% endif %}
  </div>
  {% endifnotequal %}
</div>

{% if display_plates %}
<table id="experiment-results" class="grayscale striped nice-padding">
  <thead>
    <tr>
      <th>Experiment Plate ID</th>
      <th>Worm Strain(s)</th>
      <th>RNAi Library Plate(s)</th>
      <th>Temperature</th>
      <th>Date</th>
      <th>Has any Junk?</th>
      <th>Comment</th>
    </tr>
  </thead>

  <tbody>
    {% for experiment_plate in display_plates %}
    <tr>
      <td>
        <a href="{% url 'experiment_plate_url' experiment_plate.id %}">
          {{ experiment_plate.id }}</a>
      </td>

      <td>
        {% for worm in experiment_plate.get_worm_strains %}
        {{ worm.get_display_string }}{% if not forloop.last %},{% endif %}
        {% endfor %}
      </td>

      <td>
        {{ experiment_plate.get_library_plates|join:', ' }}
      </td>

      <td>{{ experiment_plate.temperature|celsius }}</td>

      <td>{{ experiment_plate.date|date:'SHORT_DATE_FORMAT' }}</td>

      <td
        {% if experiment_plate.has_junk %}class="error-message">HAS JUNK
        {% else %}>no junk
        {% endif %}
      </td>

      <td>{{ experiment_plate.comment }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endif %}

{% endblock %}
