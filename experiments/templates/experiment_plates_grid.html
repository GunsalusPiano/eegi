{% extends 'base.html' %}
{% load extra_tags %}


{% block body_id %}experiment-plates-grid{% endblock %}


{% block page_title %}
Grid of All
{% ifequal screen_stage '1' %}
Primary
{% else %}
Secondary
{% endifequal %}
Experiments
{% endblock %}


{% block content %}
<table id="experiment-grid" class="grid">
  <thead>
    <tr>
      <th></th>

      {% for worm, temp in header %}
      <th>
        {{ worm }}
        <br>
        {{ worm.gene }}
        <br>
        {{ temp|celsius }}
      </th>
      {% endfor %}
    </tr>
  </thead>

  <tbody>
    {% for plate, worms in e.items %}
    <tr>
      <th>
        <a href="{{ plate.get_absolute_url }}">{{ plate }}</a>
      </th>

      {% for worm, temperatures in worms.items %}
        {% for temperature, experiments in temperatures.items %}
        <td
          {% if screen_stage == '1' and experiments|length < 2 %}
            class="error-background"
          {% elif screen_stage == '1' and experiments|length > 2 %}
            class="warning-background"
          {% elif experiments and screen_stage == '2' and experiments|length < 8 %}
            class="error-background"
          {% elif experiments and screen_stage == '2' and experiments|length > 8 %}
            class="warning-background"
          {% endif %}
        >
          {{ plate }}
          <br>
          {{ worm }}
          <br>
          {{ worm.gene }}
          <br>
          {{ temperature|celsius }}

          <ol>
            {% for experiment in experiments %}
            <li>
            <a href="{% url 'experiment_plate_url' experiment.id %}">
              _{{ experiment.id }}_</a>
            </li>
            {% endfor %}
          </ol>

          {% if experiments %}
            {% with c=experiments|get_comma_separated_ids %}
            <a href="
              {% url 'experiment_plates_vertical_url' c %}">
              all</a>
            {% endwith %}
          {% endif %}
        </td>
        {% endfor %}
      {% endfor %}
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
