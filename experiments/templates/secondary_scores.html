{% extends "base.html" %}
{% load extra_template_tags %}

{% block body_id %}secondary-scores{% endblock %}

{% block page_title %}
  Secondary Scores for {{ worm.id }} ({{ screen }} screen)
{% endblock %}

{% block content %}

{{ s|length }} total library well{{ s|length|pluralize}}
<br>
{{ num_passes }} pass{{ num_passes|pluralize:"es," }} criteria
<br>
{{ num_passes_stringent }} pass{{ num_passes_stringent|pluralize:"es," }}
stringent criteria
<table class="grayscale striped nice-padding">
  <thead>
    <tr>
      <th>Worm Strain</th>
      <th>Worm Genotype</th>
      <th>Library Plate</th>
      <th>Library Well</th>
      <th>Intended Clone</th>
      <th>Double Knockdown</th>
      <th>Passes Criteria?</th>
      <th>Passes Stringent Criteria?</th>
      <th>Average Score</th>
      <th colspan="{{ num_experiment_columns }}">Scores</th>
    </tr>
  </thead>

  <tbody>
    {% for well, experiments in s.items %}
    <tr>
      <td>{{ worm.id }}</td>
      <td>{{ worm.genotype }}</td>
      <td>{{ well.plate_id }}</td>
      <td>{{ well.well }}</td>
      <td>{{ well.intended_clone_id }}</td>

      <td>
      {% if well.intended_clone_id %}
        {% url 'double_knockdown_url' worm.id well.intended_clone_id temp as x %}
        <a href="{{ x }}">click</a>
      {% else %}
        No intended clone
      {% endif %}
      </td>

      <td class="
        {% if well.passes_criteria %}
          success-message
        {% else %}
          error-message
        {% endif %}"
        >{{ well.passes_criteria }}
      </td>
      <td class="
        {% if well.passes_stringent_criteria %}
          success-message
        {% else %}
          error-message
        {% endif %}"
        >{{ well.passes_stringent_criteria }}
      </td>

      <td>{{ well.avg }}</td>

      {% for experiment, score in experiments.items %}
      <td>
        <a href="{% url 'experiment_well_url' experiment.id well.well %}">
          {{ experiment.id }}@{{ well.well }}</a>
        <br>
        {{ score.score_code }} by {{ score.scorer }}
      </td>
      {% endfor %}
    </tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}
