{% extends "base.html" %}
{% load extra_tags %}

{% block body_id %}experiments{% endblock %}
{% block page_title %}Experiment Plates{% endblock %}

{% block content %}

<h4>Browse all experiments in grid format</h4>
<a href="{% url 'experiments_grid_url' 1 %}">
  Primary screen (non-junk, official temps only)</a>
<br>
<br>
<a href="{% url 'experiments_grid_url' 2 %}">
  Secondary screen (non-junk, official temps only)</a>

<hr>

<h4>Find experiment plates</h4>

{% if form.errors %}
<span class="error-message">
  Please correct the error{{ form.errors|pluralize }} below.
</span>
{% endif %}

<form id="experiment-filter-form" action="" method="get">
  <table>
    {{ form.as_table }}
  </table>
  <input type="submit" value="Submit">
</form>

{% ifnotequal total_results None %}
<div id="results-header">
  <span id="total">
    {{ total_results }} matching experiment{{ total_results|pluralize }}
  </span>

  {% if link_to_vertical %}
  <span class="vertical-links">

    <a href="{{ link_to_vertical }}"
        {% if total_results > 500 %}class="inactive-link"{% endif %}>
      See all thumbnails (max 500 expts)</a>

    <a href="{{ link_to_vertical }}?mode=big"
        {% if total_results > 50 %}class="inactive-link"{% endif %}>
      See all full-size images (max 50)</a>

    <a href="{{ link_to_vertical }}?mode=devstar"
        {% if total_results > 50 %}class="inactive-link"{% endif %}>
      See all DevStaR images (max 50)</a>
  </span>
  {% endif %}

  {% if total_results %}
  <div class="pagination-status">
    {% if display_experiments.has_previous %}
    <a href="?{% url_replace request 'page' display_experiments.previous_page_number %}">
      previous
    </a>
    {% endif %}

    <span>
      Page {{ display_experiments.number }}
      of {{ display_experiments.paginator.num_pages }}.
    </span>

    {% if display_experiments.has_next %}
    <a href="?{% url_replace request 'page' display_experiments.next_page_number %}">
      next
    </a>
    {% endif %}
  </div>
  {% endif %}
</div>
{% endifnotequal %}

{% if total_results %}
<table id="experiment-results" class="grayscale striped nice-padding">
  <thead>
    <tr>
      <th>Experiment ID</th>
      <th>Worm Strain</th>
      <th>Worm Genotype</th>
      <th>RNAi Library Plate</th>
      <th>Temperature</th>
      <th>Date</th>
      <th>Is Junk?</th>
      <th>Comment</th>
    </tr>
  </thead>

  <tbody>
    {% for experiment in display_experiments %}
    <tr>
      <td>
        <a href="{% url 'experiment_url' experiment.id %}">
          {{ experiment.id }}</a>
      </td>
      <td>{{ experiment.worm_strain }}</td>
      <td>{{ experiment.worm_strain__genotype }}</td>
      <td>{{ experiment.library_plate }}</td>
      <td>{{ experiment.temperature|get_celsius_string }}</td>
      <td>{{ experiment.date|date:"SHORT_DATE_FORMAT" }}</td>
      <td
        {% if experiment.is_junk %}
        class="error-message">JUNK
        {% else %}
          >not junk
      {% endif %}</td>
      <td>{{ experiment.comment }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endif %}

{% endblock %}
