{% extends "base.html" %}
{% load simple_tags %}
{% load image_tags %}

{% block body_id %}double-knockdown{% endblock %}

{% block page_title %}
{{ worm }} x {{ clone }}, at {{ temperature|get_celsius_string }}
{% endblock %}

{% block content %}
<div class="cleared-spaced-spans">
  <span>
    Worm strain:
    <a href="{{ worm.get_lab_website_url }}">
      {{ worm }}</a>
  </span>

  <span>
    Worm genotype: {{ worm.genotype }}
  </span>

  <span>
    RNAi clone: {{ clone }}
  </span>

  <span>
    Temperature: {{ temperature|get_celsius_string }}
    ({% get_screen_type temperature worm %})
  </span>
</div>

{% for rnai_well, date, experiments in data %}
  <table class="double-knockdown-results grayscale">
    <thead>
      <th colspan="2">
        Clone located in plate {{ rnai_well.plate }},
        well {{ rnai_well.well }};
        tested on {{ date }}
      </th>
    </thead>

    <tbody>

      <tr>
        <th>Mutant ({{ worm.gene }}) + RNAi ({{ clone.id }})</th>
        <th>Mutant ({{ worm.gene }}) + L4440 control</th>
      </tr>

      <tr>
        <td>
          {% with experiments|get_value:"mutant_rnai" as experiments %}

          <div class="carousel">
          {% for experiment in experiments %}
            {% get_image_wrapper experiment rnai_well forloop.counter experiments|length %}
          {% endfor %}
          </div>

          {% endwith %}
        </td>

        <td>
          {% with experiments|get_value:"mutant_l4440" as experiments %}

          <div class="carousel">
          {% for experiment in experiments %}
            {% with experiment.library_plate.get_l4440_wells as wells %}
            {% for well in wells %}
              {% get_image_wrapper experiment well forloop.counter wells|length %}
            {% endfor %}
            {% endwith %}
          {% endfor %}
          </div>

          {% endwith %}
        </td>
      </tr>

      <tr>
        <th>N2 control + RNAi ({{ clone.id }})</th>
        <th>N2 control + L4440 control</th>
      </tr>

      <tr>
        <td>
          {% with experiments|get_value:"n2_rnai" as experiments %}

          <div class="carousel">
          {% for experiment in experiments %}
            {% get_image_wrapper experiment rnai_well forloop.counter experiments|length %}
          {% endfor %}
          </div>

          {% endwith %}
        </td>

        <td>
          {% with experiments|get_value:"n2_l4440" as experiments %}

          <div class="carousel">
          {% for experiment in experiments %}
            {% with experiment.library_plate.get_l4440_wells as wells %}
            {% for well in wells %}
              {% get_image_wrapper experiment well forloop.counter wells|length %}
            {% endfor %}
            {% endwith %}
          {% endfor %}
          </div>

          {% endwith %}
        </td>
      </tr>
    </tbody>
  </table>
{% endfor %}

{% endblock %}
